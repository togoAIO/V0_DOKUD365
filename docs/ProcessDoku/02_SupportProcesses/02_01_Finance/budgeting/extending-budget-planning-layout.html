<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Extend the budget planning layout | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Extend the budget planning layout | WIKA Documentation ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../microsoft-dynamics-crm-365-icon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../TOC.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="extend-the-budget-planning-layout">Extend the budget planning layout</h1>


<p>This topic describes the process for extending the number of columns in the BudgetPlanLineActiveView table to accommodate additional data in the budget plan layout. This process might be required if you're comparing information over multiple years, if many scenarios are being evaluated, or if weekly or daily periods are being evaluated. This topic was written for a developer audience.</p>
<ul>
<li><strong>BudgetPlanLineActiveView table</strong> – This table contains the pivoted budget planning data. Out of the box, it contains 36 monetary columns and 36 quantity columns. This default configuration lets users manipulate the budget plan layout so that they can show and compare up to three years of monthly planning data.</li>
<li><strong>BudgetPlanWorksheetEntity entity</strong> – This entity is a counterpart of the BudgetPlanLineActiveView table and serves as a data source for the Microsoft Excel worksheet. The columns in this entity map to the columns in the BudgetPlanLineActiveView table. Any changes in the table must be replicated in the entity.</li>
</ul>
<h2 id="extend-the-columns-in-the-budgetplanlineactiveview-table">Extend the columns in the BudgetPlanLineActiveView table</h2>
<p>You can extend the columns in the BudgetPlanLineActiveView table by using a four-step process. After you complete these steps, you must build the project and validate your changes.</p>
<h3 id="step-1-add-columns-to-the-budgetplanlineactiveview-table">Step 1: Add columns to the BudgetPlanLineActiveView table</h3>
<p>You begin the process by creating a new extension, adding fields, and setting the data type for the fields that you add.</p>
<ol>
<li>Open Microsoft Visual Studio</li>
<li>Open Application explorer.</li>
<li>Create an extension on the <strong>BudgetPlanLineActiveView</strong> table to a new project.</li>
<li>Open the table in designer mode.</li>
<li>Right-click <strong>Fields</strong>, and then select <strong>New &gt; Real</strong>.</li>
<li>Name the field by using the next available name, where the suffix is incremented (for example, <strong>TransactionCurrencyAmount37</strong>).</li>
<li>Set the extended data type to <strong>BudgetPlanCurrencyAmount</strong>.</li>
<li>Right-click <strong>Fields</strong>, and then select <strong>New &gt; Real</strong>.</li>
<li>Name the field by using the next available name, where the suffix is incremented (for example, <strong>Quantity37</strong>).</li>
<li>Set the extended data type to <strong>BudgetPlanQuantity</strong>.</li>
<li>Repeat steps 5 through 10 for all the additional columns of each extended data type that you require.</li>
<li>Optional: Add the monetary columns added to the <strong>Monetary</strong> field group quantity columns to the <strong>Quantity</strong> field group.</li>
</ol>
<h3 id="step-2-add-columns-to-the-budgetplanworksheetentity-entity">Step 2: Add columns to the BudgetPlanWorksheetEntity entity</h3>
<p>To add columns to the BudgetPlanWorksheetEntity entity, follow these follow steps.</p>
<ol>
<li>Create an extension on the <strong>BudgetPlanWorksheetEntity</strong> entity to the existing project.</li>
<li>Open the entity extension in designer mode.</li>
<li>Drag the columns from the data sources node into the fields node.</li>
</ol>
<h3 id="step-3-create-an-extension-for-the-budgetplan-form">Step 3: Create an extension for the BudgetPlan form</h3>
<p>To update the <strong>BudgetPlan</strong> form so that it includes the new columns, follow these steps.</p>
<ol>
<li><p>Create an extension on the <strong>BudgetPlan</strong> form.</p>
</li>
<li><p>Replicate any events or customizations in a new event handler that exists on the <strong>TransactionCurrencyAmount</strong>, or <strong>Quantity</strong> fields, onto the new fields. The following example shows the standard events that currently exist for both <strong>CurrencyAmount</strong> and <strong>Quantity</strong>. These events must be created for anything beyond the original 36 <strong>CurrencyAmount</strong> and <strong>Quantity</strong> values.</p>
<pre><code class="lang-xpp">[FormDataFieldEventHandler(formDataFieldStr(BudgetPlan, BudgetPlanLineActiveView, TransactionCurrencyAmount37), FormDataFieldEventType::Modified)]
publicstaticvoid transactionCurrencyAmount37\_OnModified(FormDataObject \_sender, FormDataFieldEventArgs \_e)
{
    Object budgetPlanLineActiveView\_ds = \_sender.datasource() asFormDataSource;
    budgetPlanLineActiveView\_ds.updateTransactionCurrencyAmount(fieldNum(BudgetPlanLineActiveView, TransactionCurrencyAmount37));
}
[FormDataFieldEventHandler(formDataFieldStr(BudgetPlan, BudgetPlanLineActiveView, Quantity37), FormDataFieldEventType::Modified)]
publicstaticvoid quantity37\_OnModified(FormDataObject \_sender, FormDataFieldEventArgs \_e)
{
    Object budgetPlanLineActiveView\_ds = \_sender.datasource() asFormDataSource;
    budgetPlanLineActiveView\_ds.updateQuantity(fieldNum(BudgetPlanLineActiveView, Quantity37));
}
</code></pre>
</li>
<li><p>Verify that a modified event handler exists for every copy that you've created of a <strong>TransactionCurrencyAmount</strong> or <strong>Quantity</strong> column.</p>
</li>
<li><p>In the search fields above the form designer, enter <strong>LineViewLinesGrid</strong>, find the node, and expand it.</p>
<p>Cancel the search by selecting the <strong>X</strong> at the end of the search field. The lines view grid will remain expanded and in view.</p>
</li>
<li><p>Drag all the new columns that you added onto <strong>LineViewLinesGrid</strong> (the grid).</p>
</li>
<li><p>Rename the new fields so that they follow the existing naming pattern (for example, <strong>TransactionCurrencyAmount37</strong> and <strong>Quantity37</strong>).</p>
</li>
<li><p>Reorder the fields so that they are in order for <strong>Quantity</strong> and <strong>TransactionCurrencyAmounts</strong>.</p>
</li>
<li><p>Save your changes.</p>
</li>
</ol>
<h3 id="step-4-update-the-budgetplanlinefieldactiveviewmapping-class-via-a-delegate">Step 4: Update the BudgetPlanLineFieldActiveViewMapping class via a delegate</h3>
<p>To extend the mapping between the BudgetPlanLineActiveView and BudgetPlanLine tables, follow this step.</p>
<ul>
<li><p>Create a new class, and paste in the event handler method from the <strong>gettingBudgetPlanLineFieldName</strong> delegate. There should be a statement for each <strong>TransactionCurrencyAmount</strong> and <strong>Quantity</strong> field that you extended.</p>
<pre><code class="lang-xpp">[SubscribesTo(classStr(BudgetPlanLineFieldActiveViewMapping), staticDelegateStr(BudgetPlanLineFieldActiveViewMapping, gettingBudgetPlanLineFieldName))]
publicstaticvoid BudgetPlanLineFieldActiveViewMapping\_gettingBudgetPlanLineFieldName(FieldName \_budgetPlanLineActiveViewFieldName, EventHandlerResult \_result)
{
    FieldName budgetPlanLineFieldName;
    switch (\_budgetPlanLineActiveViewFieldName)
    {
        case
            fieldStr(BudgetPlanLineActiveView, TransactionCurrencyAmount37), fieldStr(BudgetPlanLineActiveView, TransactionCurrencyAmount38):
            budgetPlanLineFieldName = fieldStr(BudgetPlanLine, TransactionCurrencyAmount);
            break;
        case
            fieldStr(BudgetPlanLineActiveView, Quantity37), fieldStr(BudgetPlanLineActiveView, Quantity38):
            budgetPlanLineFieldName = fieldStr(BudgetPlanLine, Quantity);
            break;
    }
    \_result.result(budgetPlanLineFieldName);
}
</code></pre>
</li>
</ul>
<h2 id="build-the-project">Build the project</h2>
<p>Build your project, and synchronize the database.</p>
<h2 id="validate-your-changes">Validate your changes</h2>
<p>To validate your changes, you must create a layout in budget planning beyond 36 monetary and/or quantity columns. If you completed all the steps correctly, you should be able to enter a value in every column, save the value, and edit it in Excel.</p>
<p>After the changes are verified, the extension can be published and promoted beyond the local development environment.</p>
[!include[footer-include](../../includes/footer-banner.md)]</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/togoAIO/V0_DOKUD365/blob/master/ProcessDoku/02_SupportProcesses/02_01_Finance/budgeting/extending-budget-planning-layout.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
