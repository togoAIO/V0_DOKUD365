<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Add data fields in the tax integration by using extensions | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Add data fields in the tax integration by using extensions | WIKA Documentation ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../microsoft-dynamics-crm-365-icon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../TOC.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="add-data-fields-in-the-tax-integration-by-using-extension">Add data fields in the tax integration by using extension</h1>


<p>This topic explains how to use X++ extensions to add data fields in the tax integration. These fields can be extended to the tax data model of the tax service and used to determine tax codes. For more information, see <a href="tax-service-add-data-fields-tax-configurations.html">Add data fields in tax configurations</a>.</p>
<h2 id="data-model">Data model</h2>
<p>The data in the data model is carried by objects and implemented by classes.</p>
<p>Here is a list of the major objects:</p>
<ul>
<li>AxClass/TaxIntegration<strong>Document</strong>Object</li>
<li>AxClass/TaxIntegration<strong>Line</strong>Object</li>
<li>AxClass/TaxIntegration<strong>TaxLine</strong>Object</li>
</ul>
<p>The following illustration shows how these objects are related.</p>
<p><a href="media/tax-service-customize-image1.png"><img src="media/tax-service-customize-image1.png" alt="Data model object relationship."></a></p>
<p>A <strong>Document</strong> object can contain many <strong>Line</strong> objects. Each object contains metadata for the tax service.</p>
<ul>
<li><code>TaxIntegrationDocumentObject</code> has <code>originAddress</code> metadata, which contains information about the source address, and <code>includingTax</code> metadata, which indicates whether the line amount includes sales tax.</li>
<li><code>TaxIntegrationLineObject</code> has <code>itemId</code>, <code>quantity</code>, and <code>categoryId</code> metadata.</li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p><code>TaxIntegrationLineObject</code> also implements <strong>Charge</strong> objects.</p>
</div>
<h2 id="integration-flow">Integration flow</h2>
<p>The data in the flow is manipulated by activities.</p>
<h3 id="key-activities">Key activities</h3>
<ul>
<li>AxClass/TaxIntegration<strong>Calculation</strong>ActivityOnDocument</li>
<li>AxClass/TaxIntegration<strong>CurrencyExchange</strong>ActivityOnDocument</li>
<li>AxClass/TaxIntegration<strong>DataPersistence</strong>ActivityOnDocument</li>
<li>AxClass/TaxIntegration<strong>DataRetrieval</strong>ActivityOnDocument</li>
<li>AxClass/TaxIntegration<strong>SettingRetrieval</strong>ActivityOnDocument</li>
</ul>
<p>Activities are run in the following order:</p>
<ol>
<li>Setting Retrieval</li>
<li>Data Retrieval</li>
<li>Calculation Service</li>
<li>Currency Exchange</li>
<li>Data Persistence</li>
</ol>
<p>For example, extend <strong>Data Retrieval</strong> before <strong>Calculation Service</strong>.</p>
<h4 id="data-retrieval-activities">Data Retrieval activities</h4>
<p><strong>Data Retrieval</strong> activities retrieve data from the database. Adapters for different transactions are available to retrieve data from different transaction tables:</p>
<ul>
<li>AxClass/TaxIntegration<strong>PurchTable</strong>DataRetrieval</li>
<li>AxClass/TaxIntegration<strong>PurchParmTable</strong>DataRetrieval</li>
<li>AxClass/TaxIntegration<strong>PurchREQTable</strong>DataRetrieval</li>
<li>AxClass/TaxIntegration<strong>PurchRFQTable</strong>DataRetrieval</li>
<li>AxClass/TaxIntegration<strong>VendInvoiceInfoTable</strong>DataRetrieval</li>
<li>AxClass/TaxIntegration<strong>SalesTable</strong>DataRetrieval</li>
<li>AxClass/TaxIntegration<strong>SalesParm</strong>DataRetrieval</li>
</ul>
<p>In these <strong>Data Retrieval</strong> activities, data is copied from the database to <code>TaxIntegrationDocumentObject</code> and <code>TaxIntegrationLineObject</code>. Because all these activities extend the same abstract template class, they have common methods.</p>
<h4 id="calculation-service-activities">Calculation Service activities</h4>
<p>The <strong>Calculation Service</strong> activity is the link between the tax service and the tax integration. This activity is responsible for the following functions:</p>
<ol>
<li>Construct the request.</li>
<li>Post the request to the tax service.</li>
<li>Get the response from the tax service.</li>
<li>Parse the response.</li>
</ol>
<p>A data field that you add to the request will be posted together with other metadata.</p>
<h2 id="extension-implementation">Extension implementation</h2>
<p>This section provides detailed steps that explain how to implement the extension. It uses the <strong>Cost center</strong> and <strong>Project</strong> financial dimensions as examples.</p>
<h3 id="step-1-add-the-data-variable-in-the-object-class">Step 1. Add the data variable in the object class</h3>
<p>The object class contains the data variable and getter/setter methods for the data. Add the data field to either <code>TaxIntegrationDocumentObject</code> or <code>TaxIntegrationLineObject</code>, depending on the level of the field. The following example uses the line level, and the file name is <code>TaxIntegrationLineObject_Extension.xpp</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>If the data field that you're adding is at the document level, change the file name to <code>TaxIntegrationDocumentObject_Extension.xpp</code>.</p>
</div>
<pre><code class="lang-X++">[ExtensionOf(classStr(TaxIntegrationLineObject))]
final class TaxIntegrationLineObject_Extension
{
    private OMOperatingUnitNumber costCenter;
    private ProjId projectId;

    /// &lt;summary&gt;
    /// Gets a costCenter.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The cost center.&lt;/returns&gt;
    public final OMOperatingUnitNumber getCostCenter()
    {
        return this.costCenter;
    }

    /// &lt;summary&gt;
    /// Sets the cost center.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_value&quot;&gt;The cost center.&lt;/param&gt;
    public final void setCostCenter(OMOperatingUnitNumber _value)
    {
        this.costCenter = _value;
    }

    /// &lt;summary&gt;
    /// Gets a project ID.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The project ID.&lt;/returns&gt;
    public final ProjId getProjectId()
    {
        return this.projectId;
    }

    /// &lt;summary&gt;
    /// Sets the project ID.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_value&quot;&gt;The project ID.&lt;/param&gt;
    public final void setProjectId(ProjId _value)
    {
        this.projectId = _value;
    }
}
</code></pre>
<p><strong>Cost center</strong> and <strong>Project</strong> are added as private variables. Create getter and setter methods for these data fields to manipulate the data.</p>
<h3 id="step-2-retrieve-data-from-the-database">Step 2. Retrieve data from the database</h3>
<p>Specify the transaction, and extend the appropriate adapter classes to retrieve the data. For example, if you use a <strong>Purchase order</strong> transaction, you must extend <code>TaxIntegrationPurchTableDataRetrieval</code> and <code>TaxIntegrationVendInvoiceInfoTableDataRetrieval</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p><code>TaxIntegrationPurchParmTableDataRetrieval</code> is inherited from <code>TaxIntegrationPurchTableDataRetrieval</code>. It should not be changed unless the logic of the <code>purchTable</code> and <code>purchParmTable</code> tables differs.</p>
</div>
<p>If the data field should be added for all transactions, extend all <code>DataRetrieval</code> classes.</p>
<p>Because all <strong>Data Retrieval</strong> activities extend the same template class, the class structures, variables, and methods are similar.</p>
<pre><code class="lang-X++">protected TaxIntegrationDocumentObject document;

/// &lt;summary&gt;
/// Copies to the document.
/// &lt;/summary&gt;
protected abstract void copyToDocument()
{
    // It is recommended to implement as:
    //
    // this.copyToDocumentByDefault();
    // this.copyToDocumentFromHeaderTable();
    // this.copyAddressToDocument();
}
 
/// &lt;summary&gt;
/// Copies to the current line of the document.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_line&quot;&gt;The current line of the document.&lt;/param&gt;
protected abstract void copyToLine(TaxIntegrationLineObject _line)
{
    // It is recommended to implement as:
    //
    // this.copyToLineByDefault(_line);
    // this.copyToLineFromLineTable(_line);
    // this.copyQuantityAndTransactionAmountToLine(_line);
    // this.copyAddressToLine(_line);
    // this.copyToLineFromHeaderTable(_line);
}
</code></pre>
<p>The following example shows the basic structure when the <code>PurchTable</code> table is used.</p>
<pre><code class="lang-X++">public class TaxIntegrationPurchTableDataRetrieval extends TaxIntegrationAbstractDataRetrievalTemplate
{
    protected PurchTable purchTable;
    protected PurchLine purchLine;

    // Query builder methods
    [Replaceable]
    protected SysDaQueryObject getDocumentQueryObject()
    [Replaceable]
    protected SysDaQueryObject getLineQueryObject()
    [Replaceable]
    protected SysDaQueryObject getDocumentChargeQueryObject()
    [Replaceable]
    protected SysDaQueryObject getLineChargeQueryObject()

    // Data retrieval methods
    protected void copyToDocument()
    protected void copyToDocumentFromHeaderTable()
    protected void copyToLine(TaxIntegrationLineObject _line)
    protected void copyToLineFromLineTable(TaxIntegrationLineObject _line)
    ...
}
</code></pre>
<p>When the <code>CopyToDocument</code> method is called, the <code>this.purchTable</code> buffer already exists. The purpose of this method is to copy all the required data from <code>this.purchTable</code> to the <code>document</code> object by using the setter method that was created in the <code>DocumentObject</code> class.</p>
<p>Likewise, a <code>this.purchLine</code> buffer already exists in the <code>CopyToLine</code> method. The purpose of this method is to copy all the required data from <code>this.purchLine</code> to the <code>_line</code> object by using the setter method that was created in the <code>LineObject</code> class.</p>
<p>The most straightforward approach is to extend the <code>CopyToDocument</code> and <code>CopyToLine</code> methods. However, we recommend that you try the <code>copyToDocumentFromHeaderTable</code> and <code>copyToLineFromLineTable</code> methods first. If they don't work as you require, implement your own method, and call it in <code>CopyToDocument</code> and <code>CopyToLine</code>. There are three common situations where you might use this approach:</p>
<ul>
<li><p>The required field is in <code>PurchTable</code> or <code>PurchLine</code>. In this situation, you can extend <code>copyToDocumentFromHeaderTable</code> and <code>copyToLineFromLineTable</code>. Here is the sample code.</p>
<pre><code class="lang-X++">/// &lt;summary&gt;
/// Copies to the current line of the document from.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_line&quot;&gt;The current line of the document.&lt;/param&gt;
protected void copyToLineFromLineTable(TaxIntegrationLineObject _line)
{
    next copyToLineFromLineTable(_line);
    // if we already added XXX in TaxIntegrationLineObject
    _line.setXXX(this.purchLine.XXX);
}
</code></pre>
</li>
<li><p>The required data isn't in the default table of the transaction. However, there are some join relationships with the default table, and the field is required on most lines. In this situation, replace <code>getDocumentQueryObject</code> or <code>getLineObject</code> to query the table by join relationship. In the following example, the <strong>Deliver Now</strong> field is integrated with the sales order at the line level.</p>
<pre><code class="lang-X++">public class TaxIntegrationSalesTableDataRetrieval
{
    protected MCRSalesLineDropShipment mcrSalesLineDropShipment;

    /// &lt;summary&gt;
    /// Gets the query for the lines of the document.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The query for the lines of the document&lt;/returns&gt;
    [Replaceable]
    protected SysDaQueryObject getLineQueryObject()
    {
        return SysDaQueryObjectBuilder::from(this.salesLine)
            .where(this.salesLine, fieldStr(SalesLine, SalesId)).isEqualToLiteral(this.salesTable.SalesId)
            .outerJoin(this.mcrSalesLineDropShipment)
            .where(this.mcrSalesLineDropShipment, fieldStr(MCRSalesLineDropShipment, SalesLine)).isEqualTo(this.salesLine, fieldStr(SalesLine, RecId))
            .toSysDaQueryObject();
    }
}
</code></pre>
<p>In this example, a <code>mcrSalesLineDropShipment</code> buffer is declared, and the query is defined in <code>getLineQueryObject</code>. The query uses the relationship <code>MCRSalesLineDropShipment.SalesLine == SalesLine.RecId</code>. While you're extending in this situation, you can replace <code>getLineQueryObject</code> with your own constructed query object. However, note the following points:</p>
<ul>
<li>Because the return value of the <code>getLineQueryObject</code> method is <code>SysDaQueryObject</code>, you must construct this object by using the SysDa approach.</li>
<li>Can't remove existed table.</li>
</ul>
</li>
<li><p>The required data is related to the transaction table by a complicated join relationship, or the relation isn't one to one (1:1) but one to many (1:N). In this situation, things become a little complicated. This situation applies to the example of financial dimensions.</p>
<p>In this situation, you can implement your own method to retrieve the data. Here is the sample code in the <code>TaxIntegrationPurchTableDataRetrieval_Extension.xpp</code> file.</p>
<pre><code class="lang-X++">[ExtensionOf(classStr(TaxIntegrationPurchTableDataRetrieval))]
final class TaxIntegrationPurchTableDataRetrieval_Extension
{
    private const str CostCenterKey = 'CostCenter';
    private const str ProjectKey = 'Project';

    /// &lt;summary&gt;
    /// Copies to the current line of the document from.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_line&quot;&gt;The current line of the document.&lt;/param&gt;
    protected void copyToLineFromLineTable(TaxIntegrationLineObject _line)
    {
        Map dimensionAttributeMap = this.getDimensionAttributeMapByDefaultDimension(this.purchline.DefaultDimension);
        if (dimensionAttributeMap.exists(CostCenterKey))
        {
            _line.setCostCenter(dimensionAttributeMap.lookup(CostCenterKey));
        }
        if (dimensionAttributeMap.exists(ProjectKey))
        {
            _line.setProjectId(dimensionAttributeMap.lookup(ProjectKey));
        }
        next copyToLineFromLineTable(_line);
    }
    private Map getDimensionAttributeMapByDefaultDimension(RefRecId _defaultDimension)
    {
        DimensionAttribute dimensionAttribute;
        DimensionAttributeValue dimensionAttributeValue;
        DimensionAttributeValueSetItem dimensionAttributeValueSetItem;
        Map ret = new Map(Types::String, Types::String);

        select Name, RecId from dimensionAttribute
            join dimensionAttributeValue
                where dimensionAttributeValue.dimensionAttribute == dimensionAttribute.RecId
            join DimensionAttributeValueSetItem
                where DimensionAttributeValueSetItem.DimensionAttributeValue == DimensionAttributeValue.RecId
                    &amp;&amp; DimensionAttributeValueSetItem.DimensionAttributeValueSet == _defaultDimension;

        while(dimensionAttribute.RecId)
        {
            ret.insert(dimensionAttribute.Name, dimensionAttributeValue.DisplayValue);
            next dimensionAttribute;
        }
        return ret;
    }
}
</code></pre>
</li>
</ul>
<h3 id="step-3-add-data-to-the-request">Step 3. Add data to the request</h3>
<p>Extend the <code>copyToTaxableDocumentHeaderWrapperFromTaxIntegrationDocumentObject</code> or <code>copyToTaxableDocumentLineWrapperFromTaxIntegrationLineObjectByLine</code> method to add data to the request. Here is the sample code in the <code>TaxIntegrationCalculationActivityOnDocument_CalculationService_Extension.xpp</code> file.</p>
<pre><code class="lang-X++">[ExtensionOf(classStr(TaxIntegrationCalculationActivityOnDocument_CalculationService))]
final static class TaxIntegrationCalculationActivityOnDocument_CalculationService_Extension
{
    // Define key for the form in post request
    private const str IOCostCenter = 'Cost Center';
    private const str IOProject = 'Project';

    /// &lt;summary&gt;
    /// Copies to &lt;c&gt;TaxableDocumentLineWrapper&lt;/c&gt; from &lt;c&gt;TaxIntegrationLineObject&lt;/c&gt; by line.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_destination&quot;&gt;&lt;c&gt;TaxableDocumentLineWrapper&lt;/c&gt;.&lt;/param&gt;
    /// &lt;param name = &quot;_source&quot;&gt;&lt;c&gt;TaxIntegrationLineObject&lt;/c&gt;.&lt;/param&gt;
    protected static void copyToTaxableDocumentLineWrapperFromTaxIntegrationLineObjectByLine(Microsoft.Dynamics.TaxCalculation.ApiContracts.TaxableDocumentLineWrapper _destination, TaxIntegrationLineObject _source)
    {
        next copyToTaxableDocumentLineWrapperFromTaxIntegrationLineObjectByLine(_destination, _source);
        // Set the field we need to integrated for tax service
        _destination.SetField(IOCostCenter, _source.getCostCenter());
        _destination.SetField(IOProject, _source.getProjectId());
    }
}
</code></pre>
<p>In this code, <code>_destination</code> is the wrapper object that is used to generate the post request, and <code>_source</code> is the <code>TaxIntegrationLineObject</code> object.</p>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>Define the key that is used in the request form as <code>private const str</code>.</li>
<li>Set the field in the <code>copyToTaxableDocumentLineWrapperFromTaxIntegrationLineObjectByLine</code> method by using the <code>SetField</code> method. The data type of the second parameter should be <code>string</code>. If the data type isn't <code>string</code>, convert it to <code>string</code>.</li>
</ul>
</div>
<h2 id="appendix">Appendix</h2>
<p>This appendix shows the complete sample code for the integration of financial dimensions (<strong>Cost center</strong> and <strong>Project</strong>) at the line level.</p>
<h3 id="taxintegrationlineobject_extensionxpp">TaxIntegrationLineObject_Extension.xpp</h3>
<pre><code class="lang-X++">[ExtensionOf(classStr(TaxIntegrationLineObject))]
final class TaxIntegrationLineObject_Extension
{
    private OMOperatingUnitNumber costCenter;
    private ProjId projectId;

    /// &lt;summary&gt;
    /// Gets a costCenter.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The cost center.&lt;/returns&gt;
    public final OMOperatingUnitNumber getCostCenter()
    {
        return this.costCenter;
    }

    /// &lt;summary&gt;
    /// Sets the cost center.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_value&quot;&gt;The cost center.&lt;/param&gt;
    public final void setCostCenter(OMOperatingUnitNumber _value)
    {
        this.costCenter = _value;
    }

    /// &lt;summary&gt;
    /// Gets a project ID.
    /// &lt;/summary&gt;
    /// &lt;returns&gt;The project ID.&lt;/returns&gt;
    public final ProjId getProjectId()
    {
        return this.projectId;
    }

    /// &lt;summary&gt;
    /// Sets the project ID.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_value&quot;&gt;The project ID.&lt;/param&gt;
    public final void setProjectId(ProjId _value)
    {
        this.projectId = _value;
    }
}
</code></pre>
<h3 id="taxintegrationpurchtabledataretrieval_extensionxpp">TaxIntegrationPurchTableDataRetrieval_Extension.xpp</h3>
<pre><code class="lang-X++">[ExtensionOf(classStr(TaxIntegrationPurchTableDataRetrieval))]
final class TaxIntegrationPurchTableDataRetrieval_Extension
{
    private const str CostCenterKey = 'CostCenter';
    private const str ProjectKey = 'Project';

    /// &lt;summary&gt;
    /// Copies to the current line of the document from.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_line&quot;&gt;The current line of the document.&lt;/param&gt;
    protected void copyToLineFromLineTable(TaxIntegrationLineObject _line)
    {
        Map dimensionAttributeMap = this.getDimensionAttributeMapByDefaultDimension(this.purchline.DefaultDimension);
        if (dimensionAttributeMap.exists(CostCenterKey))
        {
            _line.setCostCenter(dimensionAttributeMap.lookup(CostCenterKey));
        }
        if (dimensionAttributeMap.exists(ProjectKey))
        {
            _line.setProjectId(dimensionAttributeMap.lookup(ProjectKey));
        }
        next copyToLineFromLineTable(_line);
    }
    private Map getDimensionAttributeMapByDefaultDimension(RefRecId _defaultDimension)
    {
        DimensionAttribute dimensionAttribute;
        DimensionAttributeValue dimensionAttributeValue;
        DimensionAttributeValueSetItem dimensionAttributeValueSetItem;
        Map ret = new Map(Types::String, Types::String);
        select Name, RecId from dimensionAttribute
            join dimensionAttributeValue
                where dimensionAttributeValue.dimensionAttribute == dimensionAttribute.RecId
            join DimensionAttributeValueSetItem
                where DimensionAttributeValueSetItem.DimensionAttributeValue == DimensionAttributeValue.RecId
                    &amp;&amp; DimensionAttributeValueSetItem.DimensionAttributeValueSet == _defaultDimension;
        while(dimensionAttribute.RecId)
        {
            ret.insert(dimensionAttribute.Name, dimensionAttributeValue.DisplayValue);
            next dimensionAttribute;
        }
        return ret;
    }
}
</code></pre>
<h3 id="taxintegrationcalculationactivityondocument_calculationservice_extensionxpp">TaxIntegrationCalculationActivityOnDocument_CalculationService_Extension.xpp</h3>
<pre><code class="lang-X++">[ExtensionOf(classStr(TaxIntegrationCalculationActivityOnDocument_CalculationService))]
final static class TaxIntegrationCalculationActivityOnDocument_CalculationService_Extension
{
    // Define key for the form in post request
    private const str IOCostCenter = 'Cost Center';
    private const str IOProject = 'Project';

    /// &lt;summary&gt;
    /// Copies to &lt;c&gt;TaxableDocumentLineWrapper&lt;/c&gt; from &lt;c&gt;TaxIntegrationLineObject&lt;/c&gt; by line.
    /// &lt;/summary&gt;
    /// &lt;param name = &quot;_destination&quot;&gt;&lt;c&gt;TaxableDocumentLineWrapper&lt;/c&gt;.&lt;/param&gt;
    /// &lt;param name = &quot;_source&quot;&gt;&lt;c&gt;TaxIntegrationLineObject&lt;/c&gt;.&lt;/param&gt;
    protected static void copyToTaxableDocumentLineWrapperFromTaxIntegrationLineObjectByLine(Microsoft.Dynamics.TaxCalculation.ApiContracts.TaxableDocumentLineWrapper _destination, TaxIntegrationLineObject _source)
    {
        next copyToTaxableDocumentLineWrapperFromTaxIntegrationLineObjectByLine(_destination, _source);
        // Set the field we need to integrated for tax service
        _destination.SetField(IOCostCenter, _source.getCostCenter());
        _destination.SetField(IOProject, _source.getProjectId());
    }
}
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/togoAIO/V0_DOKUD365/blob/master/ProcessDoku/02_SupportProcesses/02_01_Finance/localizations/tax-service-add-data-fields-tax-integration-by-extension.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
