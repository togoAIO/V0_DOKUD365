<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Add dimensions to Excel templates | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Add dimensions to Excel templates | WIKA Documentation ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../toc.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="add-dimensions-to-excel-templates">Add dimensions to Excel templates</h1>

[!include[banner](../includes/banner.md)]
<p>This topic provides information about dimensions, dimensions that have entities, and the dimension controls that are available.</p>
<p>The only value that is present on Microsoft Excel templates after installation is the MainAccount. This is the only dimension that all customers will have. To add the dimensions to Microsoft Excel templates you need to complete the following steps:</p>
<ol>
<li>Add dimensions to the DimensionCombinationEntity or the DimensionSet entity.</li>
<li>Add the dimensions to each template where you want dimensions in separate columns. For more information, see <a href="../office-integration/office-integration-edit-excel.md">Create Open in Excel experiences</a>.</li>
<li>Add the <a href="add-dimensions-excel-templates.html">capability to look up financial dimension values in Excel</a>.</li>
<li>Publish the template.</li>
</ol>
<p>This topic shows how to modify DimensionCombinationEntity to enable the dimensions in columns for Excel. The same steps can be used to modify the DimensionSet entity.</p>
<div class="NOTE">
<h5>Note</h5>
<p>This information is subject to change for each release. Therefore, be sure to check back frequently for the most up-to-date information.</p>
</div>
<h2 id="add-dimensions-to-dynamics-365-finance">Add dimensions to Dynamics 365 Finance</h2>
<p>With the November 2016 release, modifying the <strong>DimensionCombinationEntity</strong> has been greatly simplified with the release of the Add financial dimensions for OData Addin in Visual Studio.</p>
<ol>
<li><p>In Microsoft Visual Studio, click <strong>Dynamics 365 &gt; Addins &gt; Add financial dimensions for Odata.</strong></p>
</li>
<li><p>Type the name of the Financial dimension in the <strong>Dimension name</strong> column. This should be the exact name of the financial dimension. Select the <strong>Model</strong> that has your extensions. It should be above the AppSuite layer. Click <strong>Apply</strong>.</p>
<p><img src="media/financial-dimensions-odata.png" alt="financial dimensions for odata.">.</p>
</li>
<li><p>Compile the project, and then synchronize it with the database.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You must keep the extension name &quot;DimensionIntegration&quot; for the project to work properly.</p>
</div>
<p><img src="media/8-300x260.png" alt="Menu options to build and synchronize."></p>
</li>
<li><p>Your customization is now completed. You can test it in SQL using the following statement.</p>
<pre><code class="lang-sql">select * from DIMENSIONCOMBINATIONENTITY 
</code></pre>
</li>
</ol>
<h2 id="add-dimensions--before-dynamics-365-for-finance-and-operations">Add dimensions  before Dynamics 365 for Finance and Operations</h2>
<p>To support interactions with dimensions as columns, for example, in the Microsoft Excel integration, you must first create the dimension columns through a customization.</p>
<ol>
<li><p>Open the Application Explorer in Visual Studio (<strong>View</strong> &gt; <strong>Application Explorer</strong>).</p>
</li>
<li><p>Navigate to DimensionCombinationEntity <strong>(AOT</strong> &gt; <strong>Data Model</strong> &gt; <strong>Data Entities</strong>).</p>
</li>
<li><p>Right-click on the entity and choose <strong>Customize</strong>.</p>
<p><a href="media/5.png"><img src="media/5-300x187.png" alt="5."></a></p>
</li>
<li><p>Open the designer for the entity that you want to modify, in this example <strong>DimensionCombinationEntity</strong>.</p>
</li>
<li><p>Create a new private static method that returns a str named <strong>departmentValue</strong>.</p>
</li>
<li><p>In this method, you must get the dimension's value from <strong>DimensionAttributeValueCombination</strong>. The final method will look something like this.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// This method returns the value of Department.
/// &lt;/summary&gt;
private static str departmentValue()
{     
    Name dimensionName = 'Department';
    str sqlStatement;

    DimensionAttribute dimensionAttribute = DimensionAttribute::findByName(dimensionName);

    if (!dimensionAttribute)
    {
        sqlStatement = SysComputedColumn::returnLiteral('');
    }
    else
    {
        sqlStatement = strFmt('SELECT TOP 1 T1.%1 ', dimensionAttribute.DimensionValueColumnName);
    }

    return sqlStatement;
}
</code></pre>
</li>
<li><p>Create a new &quot;string unmapped field&quot; on the entity:</p>
<ul>
<li><p>Set the <strong>Name</strong> property to the dimension name, <strong>Department</strong>.</p>
</li>
<li><p>Set the <strong>Extended Data Type</strong> property to <strong>DimensionValue</strong>.</p>
</li>
<li><p>Set the <strong>DataEntityView Method</strong> property to the method that you created earlier (for example, <strong>departmentValue</strong>).</p>
</li>
<li><p>Set the <strong>Label</strong> property to the dimension name <strong>Department</strong>.</p>
<p><a href="media/6.png"><img src="media/6-300x64.png" alt="6."></a></p>
</li>
</ul>
</li>
<li><p>Repeat steps 5-7 for each dimension that you want to add, changing the dimension name to the appropriate dimension.</p>
</li>
<li><p>Compile the project, and then synchronize it with the database.</p>
<p><a href="media/8.png"><img src="media/8-300x260.png" alt="8."></a></p>
</li>
<li><p>Your customization is now complete. You can test it in SQL using the following statement.</p>
<pre><code class="lang-sql">select * from DIMENSIONCOMBINATIONENTITY
</code></pre>
</li>
</ol>
<h2 id="additional-resources">Additional resources</h2>
<p><a href="dimension-entry-control-migration.html">Migrate default dimensions controls to Dimension Entry controls</a></p>
<p><a href="dimension-entry-control-uptake.html">Uptake of Dimension Entry controls</a></p>
<p><a href="../extensibility/extensibility-home-page.md">Extensibility home page</a></p>
[!include[footer-include](../../../includes/footer-banner.md)]</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Customized Footer</span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
