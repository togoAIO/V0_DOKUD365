<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Migrate Segmented Entry controls | WIKA Documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Migrate Segmented Entry controls | WIKA Documentation ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../toc.html">
    
    <meta property="docfx:rel" content="../../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="migrate-segmented-entry-controls">Migrate Segmented Entry controls</h1>

[!include[banner](../includes/banner.md)]
<p>This tutorial walks you through two migration scenarios for the Segmented Entry control -  a simple scenario (for the SMAServiceOrderTable form) and a complex scenario (for the LedgerJournalTransDaily form).</p>
<h2 id="simple-migration-scenario--smaserviceordertable-form">Simple migration scenario – SMAServiceOrderTable form</h2>
<ol>
<li><p>Search for the <strong>SMAServiceOrderTable</strong> form in Application Explorer.</p>
</li>
<li><p>Add the form to the current project.</p>
</li>
<li><p>Open the form in the form design view and the code editor view.</p>
</li>
<li><p>In the form design view, find the Segmented Entry control (SEC), either by manually walking the control tree or by searching for “SegmentedEntry” in the search bar below the <strong>File</strong> tab.</p>
</li>
<li><p>Select the SEC, and verify the following information:</p>
<ul>
<li>The type for the control, as specified in parenthesis next to the control, is <strong>SegmentedEntryControl</strong>.</li>
<li>The <strong>Controller class</strong> property is set to <strong>DimensionDynamicAccountController</strong>. This property indicates the type of controller that this instance of the SEC will use. The type of controller, in turn, determines the behavior of the control.</li>
</ul>
</li>
<li><p>Switch to the code editor view, and search for all occurrences of “TODO: (Code Upgrade) [Segmented entry control]” in the form source code.</p>
</li>
<li><p>In the search results, ignore the first result, which points to the controller variable declaration. You must fix this TODO last, after you've removed all references to the controller variable.</p>
</li>
<li><p>Go through each of the remaining TODO comments, as described in the following subsections.</p>
</li>
</ol>
<h3 id="ledgerdimension-data-field">LedgerDimension data field</h3>
<p>(<strong>Form</strong> &gt; <strong>Data sources</strong> &gt; <strong>SMAServiceOrderLine</strong> &gt; <strong>Fields</strong> &gt; <strong>LedgerDimension</strong> &gt; <strong>Methods</strong>)</p>
<h5 id="dynamics-ax-2012">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    ExpenseCost_LedgerDimension.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="expensecost_ledgerdimension-control">ExpenseCost_LedgerDimension control</h3>
<p>(Search for &quot;ExpenseCost_LedgerDimension&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1">Step 1</h4>
<h5 id="dynamics-ax-2012-1">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    ExpenseCost_LedgerDimension.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-1">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't performing any additional processing, you can delete it.</p>
<h4 id="step-2">Step 2</h4>
<h5 id="dynamics-ax-2012-2">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimDynamicAccountController.loadSegments();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-2">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>loadSegments()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-3">Step 3</h4>
<h5 id="dynamics-ax-2012-3">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    switch (smaServiceOrderLine.OffsetAccountTypeExpense)
    {
        case LedgerJournalACType::Bank:
            BankAccountTable::lookupBankAccount(this);
            break;
        case LedgerJournalACType::Cust:
            CustTable::lookupCustomer(this);
            break;
        case LedgerJournalACType::FixedAssets:
            AssetTable::lookupAccountNum(this);
            break;
        case LedgerJournalACType::Project:
            ProjTable::lookupProjId(this, smaServiceOrderLine);
            break;
        case LedgerJournalACType::Vend:
            VendTable::lookupVendor(this);
            break;
        default:
            super();
            break;
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-3">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, leave the method as it is. Just remove the TODO. To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Here is an example.</p>
<pre><code class="lang-xpp">public boolean checkUseCustomLookup(int _accountTypeEnumValue, int _secondaryAccountTypeEnumValue)
{
    boolean ret;
    switch(_accountTypeEnumValue)
    {
        case LedgerJournalACType::Bank:
        case LedgerJournalACType::Cust:
        case LedgerJournalACType::FixedAssets:
        case LedgerJournalACType::Project:
        case LedgerJournalACType::Vend:
            ret = true;
            break;
        default:
            ret = false;
    }
    return ret;
}
</code></pre>
<p>Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-4">Step 4</h4>
<h5 id="dynamics-ax-2012-4">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);
    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimDynamicAccountController.segmentValueChanged(_e);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-4">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>segmentValueChanged()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-5">Step 5</h4>
<h5 id="dynamics-ax-2012-5">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();
    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimDynamicAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-5">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="controller-variable-declarations">Controller variable declarations</h3>
<h5 id="dynamics-ax-2012-6">Dynamics AX 2012</h5>
<p>Finally, go back to the first TODO, for the controller variable declaration.</p>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
/* 'dimDynamicAccountController' controller object is used with 'ExpenseCost_LedgerDimension' segmented entry controls.*/
DimensionDynamicAccountController dimDynamicAccountController;
</code></pre>
<h5 id="dynamics-ax-for-operations-6">Dynamics AX for Operations</h5>
<p>The <strong>dimDynamicAccountController</strong> variable is no longer used on the form. Therefore, you can now delete it.</p>
<h2 id="complex-migration-scenario--ledgerjournaltransdaily-form">Complex migration scenario – LedgerJournalTransDaily form</h2>
<ol>
<li><p>Search for the <strong>LedgerJournalTransDaily</strong> form in Application Explorer.</p>
</li>
<li><p>Add the form to the current project.</p>
</li>
<li><p>Open the form in the form design view and the code editor view.</p>
</li>
<li><p>In the form design view, find the SEC, either by manually walking the control tree or by searching for “SegmentedEntry” in the search bar below the <strong>File</strong> tab.</p>
</li>
<li><p>Select the SEC, and verify the following information:</p>
<ul>
<li>The type for the control, as specified in parenthesis next to the control, is <strong>SegmentedEntryControl</strong>.</li>
<li>The <strong>Controller class</strong> property is set to <strong>DimensionDynamicAccountController</strong>. This property indicates the type of controller that this instance of the SEC will use. The type of controller, in turn, determines the behavior of the control.</li>
</ul>
</li>
<li><p>Switch to the code editor view, and search for all occurrences of “TODO: (Code Upgrade) [Segmented entry control]” in the form source code.</p>
</li>
<li><p>In the search results, the first three results are for the controller variable declarations. Look at the comments that accompany the TODOs, and make a note of the mapping that shows which SEC instance uses which controller instance. You will need this mapping when you replace method calls on the controller with method calls on the control. Here is what the controller-to-control mapping looks like:</p>
<ol>
<li><p>dimAccountController</p>
<ol>
<li>LedgerJournalTrans_AccountNum</li>
<li>LedgerJournalTrans_AccountNum1</li>
<li>Group4_AccountNum</li>
</ol>
</li>
<li><p>dimOffsetAccountController</p>
<ol>
<li>GridOffsetAccount</li>
<li>LedgerJournalTrans_OffsetAccount1</li>
<li>Group4_OffsetAccount</li>
</ol>
</li>
<li><p>dimPaymentFeeAccountController</p>
<ol>
<li>CustPaymJournalFee_CustAccount</li>
</ol>
</li>
</ol>
<p>You will fix these three TODO comments at the end, after you've removed all references to the controller variables.</p>
</li>
<li><p>Go through each of the remaining TODO comments, as described in the following subsections.</p>
</li>
</ol>
<h3 id="ledgerdimension-data-field-1">LedgerDimension data field</h3>
<p>(<strong>Form</strong> &gt; <strong>Data sources</strong> &gt; <strong>LedgerJournalTrans</strong> &gt; <strong>Fields</strong> &gt; <strong>LedgerDimension</strong> &gt; <strong>Methods</strong>)</p>
<h5 id="dynamics-ax-2012-7">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
// &lt;/GEEPL&gt;
public void jumpRef()
{
    LedgerJournalTrans_AccountNum.jumpRef();
    LedgerJournalTrans_AccountNum1.jumpRef();
    Group4_AccountNum.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-7">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="offsetledgerdimension-data-field">OffsetLedgerDimension data field</h3>
<p>(<strong>Form</strong> &gt; <strong>Data sources</strong> &gt; <strong>LedgerJournalTrans</strong> &gt; <strong>Fields</strong> &gt; <strong>OffsetLedgerDimension</strong> &gt; <strong>Methods</strong>)</p>
<h5 id="dynamics-ax-2012-8">Dynamics AX 2012</h5>
<p>The <strong>OffsetLedgerDimension</strong> field’s <strong>jumpRef()</strong> method:</p>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    GridOffsetAccount.jumpRef();
    LedgerJournalTrans_OffsetAccount1.jumpRef();
    Group4_OffsetAccount.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-8">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="ledgerjournaltrans_accountnum-control">LedgerJournalTrans_AccountNum control</h3>
<p>(Search for &quot;LedgerJournalTrans_AccountNum&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-1">Step 1</h4>
<h5 id="dynamics-ax-2012-9">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    LedgerJournalTrans_AccountNum.jumpRef();
    LedgerJournalTrans_AccountNum1.jumpRef();
    Group4_AccountNum.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-9">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-2-1">Step 2</h4>
<h5 id="dynamics-ax-2012-10">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_AccountNum1.parmCurrency(ledgerJournalTrans.CurrencyCode);
    Group4_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    LedgerJournalTrans_AccountNum1.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    Group4_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    LedgerJournalTrans_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
    LedgerJournalTrans_AccountNum1.parmControlDate(ledgerJournalTrans.TransDate);
    Group4_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimAccountController.loadSegments();
    currentMainAccountId = dimAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
</code></pre>
<h5 id="dynamics-ax-for-operations-10">Dynamics AX for Operations</h5>
<ol>
<li><p>Update the <strong>initLedger()</strong> method.</p>
<pre><code class="lang-xpp">void initLedger()
{
    TransDate   dateFrom   = dateNull();
    TransDate   dateTo     = systemDateGet();
    if (element.args().dataset() == tableNum(LedgerJournalTable))
    {
        ledgerJournalTable = element.args().record();
        journalNum         = ledgerJournalTable.JournalNum;
        LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
        LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName);
        Group4_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
. . .
</code></pre>
</li>
<li><p>Update the code in the <strong>LedgerJournalTrans</strong> data source’s <strong>active()</strong> method. <strong>Note:</strong> The <strong>getValue()</strong> method should be called only if the account type is set to <strong>Ledger</strong>. Otherwise, a call to this method will cause an invalid function call.</p>
<pre><code class="lang-xpp">. . .
LedgerJournalTrans_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
LedgerJournalTrans_AccountNum1.parmCurrency(ledgerJournalTrans.CurrencyCode);
Group4_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
LedgerJournalTrans_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
LedgerJournalTrans_AccountNum1.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
Group4_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
LedgerJournalTrans_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
LedgerJournalTrans_AccountNum1.parmControlDate(ledgerJournalTrans.TransDate);
Group4_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
if (ledgerJournalTrans.AccountType == LedgerJournalACType::Ledger)
{
    currentMainAccountId = LedgerJournalTrans_AccountNum.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentMainAccountId = 0;
}
return ret;
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>CurrencyCode</strong> field.</p>
<pre><code class="lang-xpp">LedgerJournalTrans_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
LedgerJournalTrans_AccountNum1.parmCurrency(ledgerJournalTrans.CurrencyCode);
Group4_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>Company</strong> field.</p>
<pre><code class="lang-xpp">LedgerJournalTrans_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
LedgerJournalTrans_AccountNum1.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
Group4_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>TransDate</strong> field.</p>
<pre><code class="lang-xpp">LedgerJournalTrans_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
LedgerJournalTrans_AccountNum1.parmControlDate(ledgerJournalTrans.TransDate);
Group4_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
</code></pre>
</li>
<li><p>Delete the <strong>loadSegments()</strong> method.</p>
</li>
</ol>
<h4 id="step-3-1">Step 3</h4>
<h5 id="dynamics-ax-2012-11">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    // Polish sale disposal may require to filter asset that are not
    // marked for sale. lookupAccountNum method needs the ledgerJournalTrans_Asset.TransType
    // value to filter appropriately the assets. Thus, ledgerJournalTrans_Asset is
    // passed to accountNumLookup metho jumpRef d.
    // &lt;GEEPL&gt;
    if (!ledgerJournalEngine.accountNumLookup(ledgerJournalTrans_AccountNum,
        ledgerJournalTrans,
        ledgerJournalTrans.OffsetAccountType,
        ledgerJournalTrans.parmOffsetAccount(),
        ledgerJournalTrans_Asset))
    {
        super();
    }
    // &lt;/GEEPL&gt;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-11">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, leave the method as it is. Just remove the TODO. To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-4-1">Step 4</h4>
<h5 id="dynamics-ax-2012-12">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    // &lt;GIN&gt;
    if (TaxWithholdParameters_IN::checkTaxParameters()
        &amp;&amp; ledgerJournalTrans.TaxWithholdCode_IN != '')
    {
        if (Box::okCancel(&quot;@GLS222698&quot;,
            DialogButton::Cancel) == DialogButton::Cancel)
        {
            return;
        }
    }
    // &lt;/GIN&gt;
    super(_e);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimAccountController.segmentValueChanged(_e);
    currentMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(dimAccountController, currentMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-12">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// Event handler for the segment changed event.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that has been changed.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);

    // &lt;GIN&gt;
    if (TaxWithholdParameters_IN::checkTaxParameters()
        &amp;&amp; ledgerJournalTrans.TaxWithholdCode_IN != '')
    {
        if (Box::okCancel(&quot;@GLS222698&quot;,
            DialogButton::Cancel) == DialogButton::Cancel)
        {
            return;
        }
    }

    // &lt;/GIN&gt;
    if (_segment.parmName() == mainAccountDimAttrName)
    {
        previousMainAccountId = currentMainAccountId;
    }
    currentMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(LedgerJournalTrans_AccountNum, currentMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onPrimaryAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all those calls. Alternatively, you can add a new method that follows this guidance.</p>
</li>
</ol>
<h4 id="step-5-1">Step 5</h4>
<h5 id="dynamics-ax-2012-13">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();

    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-13">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="gridoffsetaccount-control">GridOffsetAccount control</h3>
<p>(Search for &quot;GridOffsetAccount&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-2">Step 1</h4>
<h5 id="dynamics-ax-2012-14">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
void gotFocus()
{
    super();
    if (ledgerJournalTable.FixedOffsetAccount)
    {
        gridOffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);
    }
    else if (!gridOffsetAccount.allowEdit())
    {
        gridOffsetAccount.allowEdit(true);
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-14">Dynamics AX for Operations</h5>
<ol>
<li><p>Add the following code to the <strong>initLedger()</strong> method, after the code that updates the ledgerJournalTable buffer.</p>
<pre><code class="lang-xpp">. . .
if (element.args().dataset() == tableNum(LedgerJournalTable))
{
    ledgerJournalTable = element.args().record();
    journalNum         = ledgerJournalTable.JournalNum;
    LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    if (ledgerJournalTable.FixedOffsetAccount)
    {               
        gridOffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);
    }
    else if (!gridOffsetAccount.allowEdit())
    {
        gridOffsetAccount.allowEdit(true);
    }
. . .
</code></pre>
</li>
<li><p>Delete the <strong>gotFocus()</strong> method.</p>
</li>
</ol>
<h4 id="step-2-2">Step 2</h4>
<h5 id="dynamics-ax-2012-15">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    GridOffsetAccount.jumpRef();
    LedgerJournalTrans_OffsetAccount1.jumpRef();
    Group4_OffsetAccount.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-15">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-3-2">Step 3</h4>
<h5 id="dynamics-ax-2012-16">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    GridOffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_OffsetAccount1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_OffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
    GridOffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_OffsetAccount1.parmCurrency(ledgerJournalTrans.CurrencyCode);
    Group4_OffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
    GridOffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    LedgerJournalTrans_OffsetAccount1.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    Group4_OffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    GridOffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
    LedgerJournalTrans_OffsetAccount1.parmControlDate(ledgerJournalTrans.TransDate);
    Group4_OffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimOffsetAccountController.loadSegments();
    currentOffsetMainAccountId = dimOffsetAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));

    // Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
    if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
    {
        GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        Group4_OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-16">Dynamics AX for Operations</h5>
<ol>
<li><p>Update the <strong>initLedger()</strong> method. <strong>Note:</strong> The <strong>getValue()</strong> method should be called only if the account type is set to <strong>Ledger</strong>. Otherwise, a call to this method will cause an invalid function call.</p>
<pre><code class="lang-xpp">void initLedger()
{
    TransDate   dateFrom   = dateNull();
    TransDate   dateTo     = systemDateGet();
    if (element.args().dataset() == tableNum(LedgerJournalTable))
    {
        ledgerJournalTable = element.args().record();
        journalNum         = ledgerJournalTable.JournalNum;
        GridOffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
        LedgerJournalTrans_OffsetAccount1.parmJournalName(ledgerJournalTable.JournalName);
        Group4_OffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
        if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
        {
            currentOffsetMainAccountId = GridOffsetAccount.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
        }
        else
        {
            currentOffsetMainAccountId = 0;
        }

        // Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
        if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
        {
            GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        }
. . .
</code></pre>
</li>
<li><p>Update the code in the <strong>LedgerJournalTrans</strong> data source’s <strong>active()</strong> method. <strong>Note:</strong> The <strong>getValue()</strong> method should be called only if the account type is set to <strong>Ledger</strong>. Otherwise, a call to this method will cause an invalid function call.</p>
<pre><code class="lang-xpp">. . .
GridOffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
LedgerJournalTrans_OffsetAccount1.parmCurrency(ledgerJournalTrans.CurrencyCode);
Group4_OffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
GridOffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
LedgerJournalTrans_OffsetAccount1.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
Group4_OffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
GridOffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
LedgerJournalTrans_OffsetAccount1.parmControlDate(ledgerJournalTrans.TransDate);
Group4_OffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue( DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}

// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{ 
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
return ret;
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>CurrencyCode</strong> field.</p>
<pre><code class="lang-xpp">GridOffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
LedgerJournalTrans_OffsetAccount1.parmCurrency(ledgerJournalTrans.CurrencyCode);
Group4_OffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>OffsetCompany</strong> field.</p>
<pre><code class="lang-xpp">GridOffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
LedgerJournalTrans_OffsetAccount1.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
Group4_OffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>TransDate</strong> field.</p>
<pre><code class="lang-xpp">GridOffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
LedgerJournalTrans_OffsetAccount1.parmControlDate(ledgerJournalTrans.TransDate);
Group4_OffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>OffsetAccountType</strong> field. <strong>Note:</strong> The <strong>getValue()</strong> method should be called only if the account type is set to <strong>Ledger</strong>. Otherwise, a call to this method cause an invalid function call.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue( DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}

// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Delete the <strong>loadSegments()</strong> method.</p>
</li>
</ol>
<h4 id="step-4-2">Step 4</h4>
<h5 id="dynamics-ax-2012-17">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    // Find the current segment index value
    int currentSegmentIndex = dimOffsetAccountController.parmControl().currentSegmentIndex();
    if ((ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger &amp;&amp;
        dimOffsetAccountController.getDimensionAttributeByControlIndex(currentSegmentIndex) != DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount)) ||
        !ledgerJournalEngine.offsetAccountNumLookUp(gridOffsetAccount, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-17">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, keep the method, but replace the controller with the control instance. In this case, because the method is overridden on the <strong>GridOffsetAccount</strong> control, even though <strong>dimOffsetAccountController</strong> was used for three different SEC instances (based on the mapping that is shown in the TODOs on controller variable declarations), we must replace the controller with only one SEC instance. Therefore, the code will look like this.</p>
<pre><code class="lang-xpp">public void lookup()
{
    // Find the current segment index value
    int currentSegmentIndex = GridOffsetAccount.getCurrentSegmentIndex();
    if ((ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger &amp;&amp; GridOffsetAccount.getDimensionAttributeByControlIndex(currentSegmentIndex) != DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount)) || !ledgerJournalEngine.offsetAccountNumLookUp(gridOffsetAccount, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<p>To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-5-2">Step 5</h4>
<h5 id="dynamics-ax-2012-18">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);
    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimOffsetAccountController.segmentValueChanged(_e);
    currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(dimOffsetAccountController, currentOffsetMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-18">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// Event handler for the segment changed event.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that was modified.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);
    currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(
    GridOffsetAccount, currentOffsetMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onOffsetAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all those calls. Alternatively, you can add a new method that follows this guidance.</p>
</li>
</ol>
<h4 id="step-6">Step 6</h4>
<h5 id="dynamics-ax-2012-19">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();

    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimOffsetAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-19">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="ledgerjournaltrans_accountnum1">LedgerJournalTrans_AccountNum1</h3>
<p>(Search for &quot;LedgerJournalTrans_AccountNum1&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-3">Step 1</h4>
<h5 id="dynamics-ax-2012-20">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    LedgerJournalTrans_AccountNum.jumpRef();
    LedgerJournalTrans_AccountNum1.jumpRef();
    Group4_AccountNum.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-20">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-2-3">Step 2</h4>
<h5 id="dynamics-ax-2012-21">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_AccountNum1.parmCurrency(ledgerJournalTrans.CurrencyCode);
    Group4_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    LedgerJournalTrans_AccountNum1.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    Group4_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    LedgerJournalTrans_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
    LedgerJournalTrans_AccountNum1.parmControlDate(ledgerJournalTrans.TransDate);
    Group4_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimAccountController.loadSegments();
    currentMainAccountId = dimAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
</code></pre>
<h5 id="dynamics-ax-for-operations-21">Dynamics AX for Operations</h5>
<p>The steps for migrating this method are the same as the steps for migrating the <strong>LedgerJournalTrans_AccountNum.loadSegments()</strong> method. Therefore, no additional steps are required. Delete this method.</p>
<h4 id="step-3-3">Step 3</h4>
<h5 id="dynamics-ax-2012-22">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    if (!ledgerJournalEngine.accountNumLookup(ledgerJournalTrans_AccountNum1, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-22">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, leave the method as it is. Just remove the TODO. To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-4-3">Step 4</h4>
<h5 id="dynamics-ax-2012-23">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);
    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimAccountController.segmentValueChanged(_e);
    currentMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(dimAccountController, currentMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-23">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// The event handler when a segment is modified.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that was modified.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);
    currentMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(
    LedgerJournalTrans_AccountNum1, currentMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onPrimaryAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all of those calls. Alternatively, you can add a new method that follows this guidance.</p>
</li>
</ol>
<h4 id="step-5-3">Step 5</h4>
<h5 id="dynamics-ax-2012-24">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();
    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-24">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="ledgerjournaltrans_offsetaccount1">LedgerJournalTrans_OffsetAccount1</h3>
<p>(Search for &quot;LedgerJournalTrans_OffsetAccount1&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-4">Step 1</h4>
<h5 id="dynamics-ax-2012-25">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    GridOffsetAccount.jumpRef();
    LedgerJournalTrans_OffsetAccount1.jumpRef();
    Group4_OffsetAccount.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-25">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-2-4">Step 2</h4>
<h5 id="dynamics-ax-2012-26">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    GridOffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_OffsetAccount1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_OffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
    GridOffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_OffsetAccount1.parmCurrency(ledgerJournalTrans.CurrencyCode);
    Group4_OffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
    GridOffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    LedgerJournalTrans_OffsetAccount1.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    Group4_OffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    GridOffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
    LedgerJournalTrans_OffsetAccount1.parmControlDate(ledgerJournalTrans.TransDate);
    Group4_OffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimOffsetAccountController.loadSegments();
    currentOffsetMainAccountId = dimOffsetAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
    // Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
    if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
    {
        GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        Group4_OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-26">Dynamics AX for Operations</h5>
<p>The migration steps for the <strong>GridOffsetAccount.loadSegments()</strong> method already made most of the changes that are required for this method. However, you must still make the following changes.</p>
<ol>
<li><p>Add a line of code to the <strong>LedgerJournalTrans</strong> data source’s <strong>active</strong> method.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue(
    DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}

// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Make the same change in the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>OffsetAccountType</strong> field.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}

// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Make the same change in the <strong>initLedger()</strong> method.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue( DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}

// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Delete the <strong>loadSegments()</strong> method.</p>
</li>
</ol>
<h4 id="step-3-4">Step 3</h4>
<h5 id="dynamics-ax-2012-27">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    // Find the current segment index value
    int currentSegmentIndex = dimOffsetAccountController.parmControl().currentSegmentIndex();
    if ((ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger &amp;&amp;
        dimOffsetAccountController.getDimensionAttributeByControlIndex(currentSegmentIndex) != DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount)) ||
        !ledgerJournalEngine.offsetAccountNumLookUp(ledgerJournalTrans_OffsetAccount1, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-27">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, keep the method, but replace the controller with the control instance. In this case, because the method is overridden on the <strong>LedgerJournalTrans_OffsetAccount1</strong> control, even though <strong>dimOffsetAccountController</strong> was used for three different SEC instances (based on the mapping that is shown in the TODOs on controller variable declarations), we must replace the controller with only one SEC instance. Therefore, the code will look like this.</p>
<pre><code class="lang-xpp">public void lookup()
{
    // Find the current segment index value
    int currentSegmentIndex = LedgerJournalTrans_OffsetAccount1.getCurrentSegmentIndex();
    if ((ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger &amp;&amp; LedgerJournalTrans_OffsetAccount1.getDimensionAttributeByControlIndex(currentSegmentIndex) != DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount)) || !ledgerJournalEngine.offsetAccountNumLookUp(ledgerJournalTrans_OffsetAccount1, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<p>To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-4-4">Step 4</h4>
<h5 id="dynamics-ax-2012-28">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimOffsetAccountController.segmentValueChanged(_e);
    currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(dimOffsetAccountController, currentOffsetMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-28">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// The event handler when a segment is modified.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that was modified.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);
    currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(
    LedgerJournalTrans_OffsetAccount1, currentOffsetMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onOffsetAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all those calls. Alternatively, you can add a new method that follows this guidance.</p>
</li>
</ol>
<h4 id="step-5-4">Step 5</h4>
<h5 id="dynamics-ax-2012-29">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();

    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimOffsetAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-29">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="custpaymjournalfee_custaccount">CustPaymJournalFee_CustAccount</h3>
<p>(Search for &quot;CustPaymJournalFee_CustAccount&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-5">Step 1</h4>
<h5 id="dynamics-ax-2012-30">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    CustPaymJournalFee_CustAccount.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-30">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-2-5">Step 2</h4>
<h5 id="dynamics-ax-2012-31">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    CustPaymJournalFee_CustAccount.parmJournalName(ledgerJournalTable.JournalName);
    CustPaymJournalFee_CustAccount.parmCurrency(custVendPaymJournalFee.FeeCurrency);
    CustPaymJournalFee_CustAccount.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimPaymentFeeAccountController.loadSegments();
    currentPaymentFeeMainAccountId = dimPaymentFeeAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
</code></pre>
<h5 id="dynamics-ax-for-operations-31">Dynamics AX for Operations</h5>
<ol>
<li><p>Update the <strong>initLedger()</strong> method.</p>
<pre><code class="lang-xpp">ledgerJournalTable = element.args().record();
journalNum = ledgerJournalTable.JournalNum;
LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName); Group4_AccountNum.parmJournalName(ledgerJournalTable.JournalName); CustPaymJournalFee_CustAccount.parmJournalName(ledgerJournalTable.JournalName);
. . .
</code></pre>
</li>
<li><p>Add the following code to the <strong>CustVendPaymJournalFee</strong> data source’s <strong>active()</strong> method. <strong>Note:</strong> The method doesn't exist, so you must override it.</p>
<pre><code class="lang-xpp">CustPaymJournalFee_CustAccount.parmCurrency(custVendPaymJournalFee.FeeCurrency);
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>CustVendPaymJournalFee</strong> data source’s <strong>FeeCurrency</strong> field. <strong>Note:</strong> The method doesn't exist, so you must override it.</p>
<pre><code class="lang-xpp">CustPaymJournalFee_CustAccount.parmCurrency(custVendPaymJournalFee.FeeCurrency);
</code></pre>
</li>
<li><p>Add the following code to the <strong>LedgerJournalTrans</strong> data source’s <strong>active()</strong> method.</p>
<pre><code class="lang-xpp">CustPaymJournalFee_CustAccount.parmControlDate(ledgerJournalTrans.TransDate);
</code></pre>
</li>
<li><p>Add the following code to the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>TransDate</strong> field.</p>
<pre><code class="lang-xpp">CustPaymJournalFee_CustAccount.parmControlDate(ledgerJournalTrans.TransDate);
</code></pre>
</li>
<li><p>Delete the <strong>loadSegments()</strong> method.</p>
</li>
</ol>
<h4 id="step-3-5">Step 3</h4>
<h5 id="dynamics-ax-2012-32">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    if (custVendPaymJournalFee.Module == ModuleCustVend::Cust)
    {
        if (custVendPaymJournalFee.LedgerJournalACType == LedgerJournalACType::Cust)
        {
            CustTable::lookupCustomer(this, ledgerJournalTrans.Company);
        }
        else if (custVendPaymJournalFee.LedgerJournalACType == LedgerJournalACType::Ledger)
        {
            super();
        }
    }
    else if (custVendPaymJournalFee.Module == ModuleCustVend::Vend)
    {
        if (custVendPaymJournalFee.LedgerJournalACType == LedgerJournalACType::Vend)
        {
            VendTable::lookupVendor(this, ledgerJournalTrans.Company);
        }
        else if (custVendPaymJournalFee.LedgerJournalACType == LedgerJournalACType::Ledger)
        {
            super();
        }
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-32">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, leave the method as it is. Just remove the TODO. To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Here is an example.</p>
<pre><code class="lang-xpp">public boolean checkUseCustomLookup(int _accountTypeEnumValue, int _secondaryAccountTypeEnumValue)
{
    boolean ret;
    switch(_accountTypeEnumValue)
    {
        case LedgerJournalACType::Bank:
        case LedgerJournalACType::Cust:
        case LedgerJournalACType::FixedAssets:
        case LedgerJournalACType::Project:
        case LedgerJournalACType::Vend:
            ret = true;
            break;
        default:
            ret = false;
    }
    return ret;
}
</code></pre>
<p>Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-4-5">Step 4</h4>
<h5 id="dynamics-ax-2012-33">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimPaymentFeeAccountController.segmentValueChanged(_e);
    currentPaymentFeeMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(dimPaymentFeeAccountController, currentPaymentFeeMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-33">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// The event handler when a segment is modified.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that was modified.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);
    currentPaymentFeeMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(
    CustPaymJournalFee_CustAccount, currentPaymentFeeMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onPrimaryAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all those calls. Alternatively, you can add a new method that can follow this guidance.</p>
</li>
</ol>
<h4 id="step-5-5">Step 5</h4>
<h5 id="dynamics-ax-2012-34">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();

    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimPaymentFeeAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-34">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="group4_accountnum">Group4_AccountNum</h3>
<p>(Search for &quot;Group4_AccountNum&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-6">Step 1</h4>
<h5 id="dynamics-ax-2012-35">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    LedgerJournalTrans_AccountNum.jumpRef();
    LedgerJournalTrans_AccountNum1.jumpRef();
    Group4_AccountNum.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-35">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-2-6">Step 2</h4>
<h5 id="dynamics-ax-2012-36">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    LedgerJournalTrans_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_AccountNum.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_AccountNum1.parmCurrency(ledgerJournalTrans.CurrencyCode);
    Group4_AccountNum.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    LedgerJournalTrans_AccountNum1.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    Group4_AccountNum.parmDataAreaId(ledgerJournalTrans.Company ? ledgerJournalTrans.Company : curext());
    LedgerJournalTrans_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);
    LedgerJournalTrans_AccountNum1.parmControlDate(ledgerJournalTrans.TransDate);
    Group4_AccountNum.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimAccountController.loadSegments();
    currentMainAccountId = dimAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
</code></pre>
<h5 id="dynamics-ax-for-operations-36">Dynamics AX for Operations</h5>
<p>The steps for migrating this method are the same as the steps for migrating the <strong>LedgerJournalTrans_AccountNum.loadSegments()</strong> method. Therefore, no additional steps are required. Delete this method.</p>
<h4 id="step-3-6">Step 3</h4>
<h5 id="dynamics-ax-2012-37">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    if (!ledgerJournalEngine.accountNumLookup(group4_AccountNum, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-37">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, leave the method as it is. Just remove the TODO. To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-4-6">Step 4</h4>
<h5 id="dynamics-ax-2012-38">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimAccountController.segmentValueChanged(_e);
    currentMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(dimAccountController, currentMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-38">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// The event handler for the segment change event.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that was modified.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);
    if (_segment.parmName() == mainAccountDimAttrName)
    {
        previousMainAccountId = currentMainAccountId;
    }
    currentMainAccountId = ledgerJournalEngine.onPrimaryAccountSegmentChanged(Group4_AccountNum, currentMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onPrimaryAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all those calls. Alternatively, you can add a new method that follows this guidance.</p>
</li>
</ol>
<h4 id="step-5-6">Step 5</h4>
<h5 id="dynamics-ax-2012-39">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();

    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-39">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h3 id="group4_offsetaccount">Group4_OffsetAccount</h3>
<p>(Search for &quot;Group4_OffsetAccount&quot; in the search bar below the <strong>Form</strong> tab.)</p>
<h4 id="step-1-7">Step 1</h4>
<h5 id="dynamics-ax-2012-40">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
void gotFocus()
{
    super();
    if (ledgerJournalTable.FixedOffsetAccount)
    {
        group4_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);
    }
    else if (!group4_OffsetAccount.allowEdit())
    {
        group4_OffsetAccount.allowEdit(true);
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-40">Dynamics AX for Operations</h5>
<ol>
<li><p>Update the code in the <strong>initLedger()</strong> method, after the code that updates the ledgerJournalTable buffer.</p>
<pre><code class="lang-xpp">. . .
if (ledgerJournalTable.FixedOffsetAccount)
{
    gridOffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger); group4_OffsetAccount.allowEdit(ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger);
}
else if (!gridOffsetAccount.allowEdit())
{
    gridOffsetAccount.allowEdit(true);
    group4_OffsetAccount.allowEdit(true);
}
. . .
</code></pre>
</li>
<li><p>Delete the <strong>gotFocus()</strong> method.</p>
</li>
</ol>
<h4 id="step-2-7">Step 2</h4>
<h5 id="dynamics-ax-2012-41">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public void jumpRef()
{
    GridOffsetAccount.jumpRef();
    LedgerJournalTrans_OffsetAccount1.jumpRef();
    Group4_OffsetAccount.jumpRef();
}
</code></pre>
<h5 id="dynamics-ax-for-operations-41">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>jumpRef()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h4 id="step-3-7">Step 3</h4>
<h5 id="dynamics-ax-2012-42">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void loadSegments()
{
    super();
    GridOffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
    LedgerJournalTrans_OffsetAccount1.parmJournalName(ledgerJournalTable.JournalName);
    Group4_OffsetAccount.parmJournalName(ledgerJournalTable.JournalName);
    GridOffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
    LedgerJournalTrans_OffsetAccount1.parmCurrency(ledgerJournalTrans.CurrencyCode);
    Group4_OffsetAccount.parmCurrency(ledgerJournalTrans.CurrencyCode);
    GridOffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    LedgerJournalTrans_OffsetAccount1.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    Group4_OffsetAccount.parmDataAreaId(ledgerJournalTrans.getOffsetCompany());
    GridOffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);
    LedgerJournalTrans_OffsetAccount1.parmControlDate(ledgerJournalTrans.TransDate);
    Group4_OffsetAccount.parmControlDate(ledgerJournalTrans.TransDate);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimOffsetAccountController.loadSegments();
    currentOffsetMainAccountId = dimOffsetAccountController.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));

    // Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
    if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
    {
        GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
        Group4_OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-42">Dynamics AX for Operations</h5>
<p>The migration steps for the <strong>GridOffsetAccount.loadSegments()</strong> method already made most of the changes that are required for this method. However, you must still make the following changes.</p>
<ol>
<li><p>Update the code in the <strong>LedgerJournalTrans</strong> data source’s <strong>active</strong> method.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}

// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    Group4_OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Make the same change in the <strong>modified()</strong> method of the <strong>LedgerJournalTrans</strong> data source’s <strong>OffsetAccountType</strong> field.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}
// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    Group4_OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Make the same change in the <strong>initLedger()</strong> method.</p>
<pre><code class="lang-xpp">if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    currentOffsetMainAccountId = GridOffsetAccount.getValue(DimensionAttribute::getWellKnownDimensionAttribute(DimensionAttributeType::MainAccount));
}
else
{
    currentOffsetMainAccountId = 0;
}
// Lock the main account segment if &quot;Fixed offset account&quot; is selected in Journal Names
if (ledgerJournalTrans.OffsetAccountType == LedgerJournalACType::Ledger)
{
    GridOffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    LedgerJournalTrans_OffsetAccount1.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
    Group4_OffsetAccount.parmLockMainAccountSegment(ledgerJournalTable.FixedOffsetAccount);
}
</code></pre>
</li>
<li><p>Delete the <strong>loadSegments()</strong> method.</p>
</li>
</ol>
<h4 id="step-4-7">Step 4</h4>
<h5 id="dynamics-ax-2012-43">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] Fix controller usage, if any, in this method based on the migration guidance */
public void lookup()
{
    if (!ledgerJournalEngine.offsetAccountNumLookUp(group4_OffsetAccount, ledgerJournalTrans))
    {
        super();
    }
}
</code></pre>
<h5 id="dynamics-ax-for-operations-43">Dynamics AX for Operations</h5>
<p>This method implements a custom lookup for the control. Therefore, leave the method as it is. Just remove the TODO. To hook up custom lookups, you must override the SEC’s <strong>checkUseCustomLookup</strong> method. Additionally, make sure that the <strong>closeSelectRecord</strong> method on the custom lookup form is overridden. For an example, see the <strong>CustTableLookup</strong> form.</p>
<h4 id="step-5-7">Step 5</h4>
<h5 id="dynamics-ax-2012-44">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] For custom implementation, code in this method needs to be moved elsewhere based on the migration guidance */
public void segmentValueChanged(SegmentValueChangedEventArgs _e)
{
    super(_e);

    /* TODO: (Code Upgrade) [Segmented entry control] Replace this based on the migration guidance */
    // dimOffsetAccountController.segmentValueChanged(_e);
    currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(dimOffsetAccountController, currentOffsetMainAccountId, ledgerJournalTrans);
}
</code></pre>
<h5 id="dynamics-ax-for-operations-44">Dynamics AX for Operations</h5>
<ol>
<li><p>Override the <strong>onSegmentChanged()</strong> method on the control, and add the following code to it.</p>
<pre><code class="lang-xpp">/// &lt;summary&gt;
/// The event handler for the segment change event.
/// &lt;/summary&gt;
/// &lt;param name = &quot;_segment&quot;&gt;The segment that was modified.&lt;/param&gt;
public void onSegmentChanged(DimensionControlSegment _segment)
{
    super(_segment);
    currentOffsetMainAccountId = ledgerJournalEngine.onOffsetAccountSegmentChanged(
    Group4_OffsetAccount, currentOffsetMainAccountId, ledgerJournalTrans);
}
</code></pre>
</li>
<li><p>Delete the <strong>segmentValueChanged()</strong> method. <strong>Note:</strong> The preceding code for the <strong>onSegmentChanged()</strong> method will not compile, because the <strong>onOffsetAccountSegmentChanged()</strong> method expects a controller object, but this code passes an instance of the SEC. To call methods on the control instance, you must change the method’s signature and its implementation accordingly. This method is used by more than 50 callers. Therefore, you would also have to update all those calls. Alternatively, you can add a new method that follows this guidance.</p>
</li>
</ol>
<h4 id="step-6-1">Step 6</h4>
<h5 id="dynamics-ax-2012-45">Dynamics AX 2012</h5>
<pre><code class="lang-xpp">/* TODO: (Code Upgrade) [Segmented entry control] This method can be removed if there is no custom implementation */
public boolean validate()
{
    boolean isValid;
    isValid = super();

    /* TODO: (Code Upgrade) [Segmented entry control] This statement can be removed if there is no custom logic */
    // isValid = dimOffsetAccountController.validate() &amp;&amp; isValid;
    return isValid;
}
</code></pre>
<h5 id="dynamics-ax-for-operations-45">Dynamics AX for Operations</h5>
<p>Because this method only calls the <strong>validate()</strong> method on the control and doesn't perform any additional processing, you can delete it.</p>
<h2 id="additional-resources">Additional resources</h2>
<p><a href="segmented-entry-control-dialog-support.html">Support for Segmented Entry controls on dialogs</a></p>
<p><a href="segmented-entry-control-metadata-specification.html">Design-time metadata for Segmented Entry controls</a></p>
<p><a href="segmented-entry-control-parm-method-specification.html">Parm methods for Segmented Entry controls</a></p>
<p><a href="segmented-entry-control-migration-guidance.html">Migration guidance for Segmented Entry controls</a></p>
[!include[footer-include](../../../includes/footer-banner.md)]</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/togoAIO/V0_DOKUD365/blob/master/ProcessDoku/02_SupportProcesses/02_01_Finance/financial/segmented-entry-control-conversion.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Customized Footer</span>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
